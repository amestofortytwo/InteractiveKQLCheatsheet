const data = {
    "Microsoft": {
        "Automated Logic WebCTRL": {},
        "Azure Active Directory": {
            "SigninLogs": {
                "TenantId": "",
                "SourceSystem": "",
                "TimeGenerated": "",
                "ResourceId": "",
                "OperationName": "",
                "OperationVersion": "",
                "Category": "",
                "ResultType": "",
                "ResultSignature": "",
                "ResultDescription": "",
                "DurationMs": "",
                "CorrelationId": "",
                "Resource": "",
                "ResourceGroup": "",
                "ResourceProvider": "",
                "Identity": "",
                "Level": "",
                "Location": "",
                "AlternateSignInName": "",
                "AppDisplayName": "",
                "AppId": "",
                "AuthenticationContextClassReferences": "",
                "AuthenticationDetails": "",
                "AppliedEventListeners": "",
                "AuthenticationMethodsUsed": "",
                "AuthenticationProcessingDetails": "",
                "AuthenticationRequirement": "",
                "AuthenticationRequirementPolicies": "",
                "ClientAppUsed": "",
                "ConditionalAccessPolicies": "",
                "ConditionalAccessStatus": "",
                "CreatedDateTime": "",
                "DeviceDetail": "",
                "IsInteractive": "",
                "Id": "",
                "IPAddress": "",
                "IsRisky": "",
                "LocationDetails": "",
                "MfaDetail": "",
                "NetworkLocationDetails": "",
                "OriginalRequestId": "",
                "ProcessingTimeInMilliseconds": "",
                "RiskDetail": "",
                "RiskEventTypes": "",
                "RiskEventTypes_V2": "",
                "RiskLevelAggregated": "",
                "RiskLevelDuringSignIn": "",
                "RiskState": "",
                "ResourceDisplayName": "",
                "ResourceIdentity": "",
                "ResourceServicePrincipalId": "",
                "ServicePrincipalId": "",
                "ServicePrincipalName": "",
                "Status": "",
                "TokenIssuerName": "",
                "TokenIssuerType": "",
                "UserAgent": "",
                "UserDisplayName": "",
                "UserId": "",
                "UserPrincipalName": "",
                "AADTenantId": "",
                "UserType": "",
                "FlaggedForReview": "",
                "IPAddressFromResourceProvider": "",
                "SignInIdentifier": "",
                "SignInIdentifierType": "",
                "ResourceTenantId": "",
                "HomeTenantId": "",
                "UniqueTokenIdentifier": "",
                "SessionLifetimePolicies": "",
                "AutonomousSystemNumber": "",
                "AppliedConditionalAccessPolicies": "",
                "RiskLevel": "",
                "Type": ""
            },
            "AuditLogs": {
                "TenantId": "",
                "SourceSystem": "",
                "TimeGenerated": "",
                "ResourceId": "",
                "OperationName": "",
                "OperationVersion": "",
                "Category": "",
                "ResultType": "",
                "ResultSignature": "",
                "ResultDescription": "",
                "DurationMs": "",
                "CorrelationId": "",
                "Resource": "",
                "ResourceGroup": "",
                "ResourceProvider": "",
                "Identity": "",
                "Level": "",
                "Location": "",
                "AdditionalDetails": "",
                "Id": "",
                "InitiatedBy": "",
                "LoggedByService": "",
                "Result": "",
                "ResultReason": "",
                "TargetResources": "",
                "AADTenantId": "",
                "ActivityDisplayName": "",
                "ActivityDateTime": "",
                "AADOperationType": "",
                "Type": ""
            },
            "AADNonInteractiveUserSignInLogs": {
                "TenantId": "",
                "SourceSystem": "",
                "TimeGenerated": "",
                "OperationName": "",
                "OperationVersion": "",
                "Category": "",
                "ResultType": "",
                "ResultSignature": "",
                "ResultDescription": "",
                "DurationMs": "",
                "CorrelationId": "",
                "ResourceGroup": "",
                "Identity": "",
                "Level": "",
                "Location": "",
                "AlternateSignInName": "",
                "AppDisplayName": "",
                "AppId": "",
                "AuthenticationContextClassReferences": "",
                "AuthenticationDetails": "",
                "AppliedEventListeners": "",
                "AuthenticationMethodsUsed": "",
                "AuthenticationProcessingDetails": "",
                "AuthenticationRequirement": "",
                "AuthenticationRequirementPolicies": "",
                "AutonomousSystemNumber": "",
                "ClientAppUsed": "",
                "ConditionalAccessPolicies": "",
                "ConditionalAccessPoliciesV2": "",
                "ConditionalAccessStatus": "",
                "CreatedDateTime": "",
                "DeviceDetail": "",
                "HomeTenantId": "",
                "IsInteractive": "",
                "Id": "",
                "IPAddress": "",
                "IsRisky": "",
                "LocationDetails": "",
                "MfaDetail": "",
                "NetworkLocationDetails": "",
                "OriginalRequestId": "",
                "ProcessingTimeInMs": "",
                "ResourceDisplayName": "",
                "ResourceIdentity": "",
                "ResourceServicePrincipalId": "",
                "ResourceTenantId": "",
                "RiskDetail": "",
                "RiskEventTypes": "",
                "RiskEventTypes_V2": "",
                "RiskLevelAggregated": "",
                "RiskLevelDuringSignIn": "",
                "RiskState": "",
                "ServicePrincipalId": "",
                "SessionLifetimePolicies": "",
                "SignInEventTypes": "",
                "Status": "",
                "TokenIssuerName": "",
                "TokenIssuerType": "",
                "UniqueTokenIdentifier": "",
                "UserAgent": "",
                "UserDisplayName": "",
                "UserId": "",
                "UserPrincipalName": "",
                "Type": ""
            },
            "AADServicePrincipalSignInLogs": {
                "TenantId": "",
                "SourceSystem": "",
                "TimeGenerated": "",
                "OperationName": "",
                "OperationVersion": "",
                "Category": "",
                "ResultType": "",
                "ResultSignature": "",
                "ResultDescription": "",
                "DurationMs": "",
                "CorrelationId": "",
                "ResourceGroup": "",
                "Identity": "",
                "Level": "",
                "Location": "",
                "AppId": "",
                "AuthenticationContextClassReferences": "",
                "AuthenticationProcessingDetails": "",
                "ConditionalAccessPolicies": "",
                "ConditionalAccessPoliciesV2": "",
                "ConditionalAccessStatus": "",
                "FederatedCredentialId": "",
                "Id": "",
                "IPAddress": "",
                "LocationDetails": "",
                "ResourceDisplayName": "",
                "ResourceIdentity": "",
                "ResourceServicePrincipalId": "",
                "ServicePrincipalCredentialKeyId": "",
                "ServicePrincipalCredentialThumbprint": "",
                "ServicePrincipalId": "",
                "ServicePrincipalName": "",
                "UniqueTokenIdentifier": "",
                "Type": ""
            },
            "AADManagedIdentitySignInLogs": {
                "TenantId": "",
                "SourceSystem": "",
                "TimeGenerated": "",
                "OperationName": "",
                "OperationVersion": "",
                "Category": "",
                "ResultType": "",
                "ResultSignature": "",
                "ResultDescription": "",
                "DurationMs": "",
                "CorrelationId": "",
                "ResourceGroup": "",
                "Identity": "",
                "Level": "",
                "Location": "",
                "AppId": "",
                "AuthenticationContextClassReferences": "",
                "AuthenticationProcessingDetails": "",
                "ConditionalAccessPolicies": "",
                "ConditionalAccessPoliciesV2": "",
                "ConditionalAccessStatus": "",
                "FederatedCredentialId": "",
                "Id": "",
                "IPAddress": "",
                "LocationDetails": "",
                "ResourceDisplayName": "",
                "ResourceIdentity": "",
                "ResourceServicePrincipalId": "",
                "ServicePrincipalCredentialKeyId": "",
                "ServicePrincipalCredentialThumbprint": "",
                "ServicePrincipalId": "",
                "ServicePrincipalName": "",
                "UniqueTokenIdentifier": "",
                "Type": ""
            },
            "AADProvisioningLogs": {
                "TenantId": "",
                "AADTenantId": "",
                "TimeGenerated": "",
                "OperationName": "",
                "OperationVersion": "",
                "Category": "",
                "ResultType": "",
                "ResultSignature": "",
                "ResultDescription": "",
                "DurationMs": "",
                "CorrelationId": "",
                "Action": "",
                "ChangeId": "",
                "CycleId": "",
                "Id": "",
                "InitiatedBy": "",
                "JobId": "",
                "ModifiedProperties": "",
                "ProvisioningSteps": "",
                "ServicePrincipal": "",
                "SourceIdentity": "",
                "SourceSystem": "",
                "StatusInfo": "",
                "TargetIdentity": "",
                "TargetSystem": "",
                "ProvisioningAction": "",
                "ProvisioningStatusInfo": "",
                "Type": ""
            },
            "ADFSSignInLogs": {
                "TenantId": "",
                "SourceSystem": "",
                "TimeGenerated": "",
                "OperationName": "",
                "OperationVersion": "",
                "Category": "",
                "ResultType": "",
                "ResultSignature": "",
                "ResultDescription": "",
                "DurationMs": "",
                "CorrelationId": "",
                "ResourceGroup": "",
                "Identity": "",
                "Level": "",
                "Location": "",
                "AlternateSignInName": "",
                "AppDisplayName": "",
                "AppId": "",
                "AuthenticationDetails": "",
                "AuthenticationProcessingDetails": "",
                "AuthenticationRequirement": "",
                "AuthenticationRequirementPolicies": "",
                "ConditionalAccessPolicies": "",
                "ConditionalAccessPoliciesV2": "",
                "ConditionalAccessStatus": "",
                "CreatedDateTime": "",
                "DeviceDetail": "",
                "IsInteractive": "",
                "Id": "",
                "IPAddress": "",
                "NetworkLocationDetails": "",
                "OriginalRequestId": "",
                "ProcessingTimeInMs": "",
                "ResourceDisplayName": "",
                "ResourceIdentity": "",
                "ResourceTenantId": "",
                "Requirement": "",
                "Status": "",
                "TokenIssuerName": "",
                "TokenIssuerType": "",
                "UniqueTokenIdentifier": "",
                "UserAgent": "",
                "UserDisplayName": "",
                "UserId": "",
                "UserPrincipalName": "",
                "Type": ""
            },
            "AADUserRiskEvents": {
                "TenantId": "",
                "Activity": "",
                "ActivityDateTime": "",
                "AdditionalInfo": "",
                "CorrelationId": "",
                "DetectedDateTime": "",
                "DetectionTimingType": "",
                "Id": "",
                "IpAddress": "",
                "LastUpdatedDateTime": "",
                "Location": "",
                "RequestId": "",
                "RiskDetail": "",
                "RiskEventType": "",
                "RiskLevel": "",
                "RiskState": "",
                "Source": "",
                "TokenIssuerType": "",
                "UserDisplayName": "",
                "UserId": "",
                "UserPrincipalName": "",
                "TimeGenerated": "",
                "OperationName": "",
                "SourceSystem": "",
                "Type": ""
            },
            "AADRiskyUsers": {
                "TenantId": "",
                "Id": "",
                "IsDeleted": "",
                "IsProcessing": "",
                "RiskDetail": "",
                "RiskLastUpdatedDateTime": "",
                "RiskLevel": "",
                "RiskState": "",
                "UserDisplayName": "",
                "UserPrincipalName": "",
                "TimeGenerated": "",
                "OperationName": "",
                "CorrelationId": "",
                "SourceSystem": "",
                "Type": ""
            },
            "NetworkAccessTraffic": {
                "TenantId": "",
                "CorrelationId": "",
                "TimeGenerated": "",
                "TimeStamp": "",
                "DestinationIp": "",
                "DestinationPort": "",
                "DestinationFQDN": "",
                "SourceIp": "",
                "SourcePort": "",
                "DeviceId": "",
                "DeviceOperatingSystem": "",
                "DeviceOperatingSystemVersion": "",
                "UserId": "",
                "UserPrincipalName": "",
                "NetworkProtocol": "",
                "TrafficType": "",
                "AgentVersion": "",
                "SourceSystem": "",
                "Type": ""
            },
            "AADRiskyServicePrincipals": {
                "TenantId": "",
                "AccountEnabled": "",
                "AppId": "",
                "DisplayName": "",
                "Id": "",
                "IsProcessing": "",
                "RiskDetail": "",
                "RiskLastUpdatedDateTime": "",
                "RiskLevel": "",
                "RiskState": "",
                "ServicePrincipalType": "",
                "TimeGenerated": "",
                "OperationName": "",
                "CorrelationId": "",
                "SourceSystem": "",
                "Type": ""
            },
            "AADServicePrincipalRiskEvents": {
                "TenantId": "<h1> test </h1>",
                "Activity": "",
                "ActivityDateTime": "",
                "AdditionalInfo": "",
                "AppId": "",
                "CorrelationId": "",
                "DetectedDateTime": "",
                "DetectionTimingType": "",
                "Id": "",
                "IpAddress": "",
                "KeyIds": "",
                "LastUpdatedDateTime": "",
                "Location": "",
                "RequestId": "",
                "RiskDetail": "",
                "RiskEventType": "",
                "RiskLevel": "",
                "RiskState": "",
                "ServicePrincipalDisplayName": "",
                "ServicePrincipalId": "",
                "Source": "",
                "TokenIssuerType": "",
                "TimeGenerated": "",
                "OperationName": "",
                "SourceSystem": "",
                "Type": ""
            }
        },
        "Azure Active Directory Identity Protection": "",
        "Azure Activity": "",
        "Azure Batch Account": "",
        "Azure Cognitive Search": "",
        "Azure Data Lake Storage Gen1": "",
        "Azure DDoS Protection": "",
        "Azure Event Hub": "",
        "Azure Information Protection": "",
        "Azure Key Vault": "",
        "Azure Kubernetes Service (AKS)": "",
        "Azure Logic Apps": "",
        "Azure Service Bus": "",
        "Azure Storage Account": "",
        "Azure Stream Analytics": "",
        "Azure Web Application Firewall (WAF)": "",
        "Common Event Format (CEF)": {
            "Activity":"Type: string. <br>A string that represents a human-readable and understandable description of the event.",
            "AdditionalExtensions":"Type: string. <br>A placeholder for additional fields. Fields are logged as key-value pairs."  ,
            "ApplicationProtocol":"Type: string. <br>The protocol used in the application, such as HTTP, HTTPS, SSHv2, Telnet, POP, IMPA, IMAPS, and so on.",
            "CommunicationDirection":"Type: string. <br>Any information about the direction the observed communication has taken. Valid values: 0 = Inbound, 1 = Outbound.",
            "Computer":"Type: string. <br>Host, from Syslog.",
            "DestinationDnsDomain":"Type: string. <br>The DNS part of the fully-qualified domain name (FQDN).",
            "DestinationHostName":"Type: string. <br>The destination that the event refers to in an IP network. The format should be an FQDN associated with the destination node, when a node is available. For example: host.domain.com or host.",
            "DestinationIP":"Type: string. <br>The destination IpV4 address that the event refers to in an IP network.",
            "DestinationMACAddress":"Type: string. <br>The destination MAC address (FQDN).",
            "DestinationNTDomain":"Type: string. <br>The Windows domain name of the destination address.",
            "DestinationPort":"Type: int. <br>Destination port. Valid values: 0 - 65535.",
            "DestinationProcessId":"Type: int. <br>The ID of the destination process associated with the event.",
            "DestinationProcessName":"Type: string. <br>The name of the event's destination process, such as telnetd or sshd.",
            "DestinationServiceName":"Type: string. <br>The service that is targeted by the event. For example: sshd.",
            "DestinationTranslatedAddress":"Type: string. <br>Identifies the translated destination referred to by the event in an IP network, as an IPv4 IP address.",
            "DestinationTranslatedPort":"Type: int. <br>Port after translation, such as a firewall Valid port numbers: 0 - 65535.",
            "DestinationUserID":"Type: string. <br>Identifies the destination user by ID. For example: in Unix, the root user is generally associated with the user ID 0.",
            "DestinationUserName":"Type: string. <br>Identifies the destination user by name.",
            "DestinationUserPrivileges":"Type: string. <br>Defines the destination use's privileges. Valid values: Admninistrator, User, Guest.",
            "DeviceAction":"Type: string. <br>The action mentioned in the event.",
            "DeviceAddress":"Type: string. <br>The IPv4 address of the device generating the event.",
            "DeviceCustomDate1":"Type: string. <br>One of two timestamp fields available to map fields that do not apply to any other in this dictionary. Use sparingly and seek a more specific, dictionary supplied field when possible.",
            "DeviceCustomDate1Label":"Type: string. <br>All custom fields have a corresponding label field. Each of these fields is a string and describes the purpose of the custom field.",
            "DeviceCustomDate2":"Type: string. <br>One of two timestamp fields available to map fields that do not apply to any other in this dictionary. Use sparingly and seek a more specific, dictionary supplied field when possible.",
            "DeviceCustomDate2Label":"Type: string. <br>All custom fields have a corresponding label field. Each of these fields is a string and describes the purpose of the custom field.",
            "DeviceCustomFloatingPoint1":"Type: real. <br>One of four floating point fields available to map fields that do not apply to any other in this dictionary.",
            "DeviceCustomFloatingPoint1Label":"Type: string. <br>All custom fields have a corresponding label field. Each of these fields is a string and describes the purpose of the custom field.",
            "DeviceCustomFloatingPoint2":"Type: real. <br>One of four floating point fields available to map fields that do not apply to any other in this dictionary.",
            "DeviceCustomFloatingPoint2Label":"Type: string. <br>All custom fields have a corresponding label field. Each of these fields is a string and describes the purpose of the custom field.",
            "DeviceCustomFloatingPoint3":"Type: real. <br>One of four floating point fields available to map fields that do not apply to any other in this dictionary.",
            "DeviceCustomFloatingPoint3Label":"Type: string. <br>All custom fields have a corresponding label field. Each of these fields is a string and describes the purpose of the custom field.",
            "DeviceCustomFloatingPoint4":"Type: real. <br>One of four floating point fields available to map fields that do not apply to any other in this dictionary.",
            "DeviceCustomFloatingPoint4Label":"Type: string. <br>All custom fields have a corresponding label field. Each of these fields is a string and describes the purpose of the custom field.",
            "DeviceCustomIPv6Address1":"Type: string. <br>One of four IPv6 address fields available to map fields that do not apply to any other in this dictionary.",
            "DeviceCustomIPv6Address1Label":"Type: string. <br>All custom fields have a corresponding label field. Each of these fields is a string and describes the purpose of the custom field.",
            "DeviceCustomIPv6Address2":"Type: string. <br>One of four IPv6 address fields available to map fields that do not apply to any other in this dictionary.",
            "DeviceCustomIPv6Address2Label":"Type: string. <br>All custom fields have a corresponding label field. Each of these fields is a string and describes the purpose of the custom field.",
            "DeviceCustomIPv6Address3":"Type: string. <br>One of four IPv6 address fields available to map fields that do not apply to any other in this dictionary.",
            "DeviceCustomIPv6Address3Label":"Type: string. <br>All custom fields have a corresponding label field. Each of these fields is a string and describes the purpose of the custom field.",
            "DeviceCustomIPv6Address4":"Type: string. <br>One of four IPv6 address fields available to map fields that do not apply to any other in this dictionary.",
            "DeviceCustomIPv6Address4Label":"Type: string. <br>All custom fields have a corresponding label field. Each of these fields is a string and describes the purpose of the custom field.",
            "DeviceCustomNumber1":"Type: int. <br>Soon to be a deprecated field. Will be replaced by FieldDeviceCustomNumber1.",
            "DeviceCustomNumber1Label":"Type: string. <br>All custom fields have a corresponding label field. Each of these fields is a string and describes the purpose of the custom field.",
            "DeviceCustomNumber2":"Type: int. <br>Soon to be a deprecated field. Will be replaced by FieldDeviceCustomNumber2.",
            "DeviceCustomNumber2Label":"Type: string. <br>All custom fields have a corresponding label field. Each of these fields is a string and describes the purpose of the custom field.",
            "DeviceCustomNumber3":"Type: int. <br>Soon to be a deprecated field. Will be replaced by FieldDeviceCustomNumber3.",
            "DeviceCustomNumber3Label":"Type: string. <br>All custom fields have a corresponding label field. Each of these fields is a string and describes the purpose of the custom field.",
            "DeviceCustomString1":"Type: string. <br>One of six strings available to map fields that do not apply to any other in this dictionary. Use sparingly and seek a more specific, dictionary supplied field when possible.",
            "DeviceCustomString1Label":"Type: string. <br>All custom fields have a corresponding label field. Each of these fields is a string and describes the purpose of the custom field.",
            "DeviceCustomString2":"Type: string. <br>One of six strings available to map fields that do not apply to any other in this dictionary. Use sparingly and seek a more specific, dictionary supplied field when possible.",
            "DeviceCustomString2Label":"Type: string. <br>All custom fields have a corresponding label field. Each of these fields is a string and describes the purpose of the custom field.",
            "DeviceCustomString3":"Type: string. <br>One of six strings available to map fields that do not apply to any other in this dictionary. Use sparingly and seek a more specific, dictionary supplied field when possible.",
            "DeviceCustomString3Label":"Type: string. <br>All custom fields have a corresponding label field. Each of these fields is a string and describes the purpose of the custom field.",
            "DeviceCustomString4":"Type: string. <br>One of six strings available to map fields that do not apply to any other in this dictionary. Use sparingly and seek a more specific, dictionary supplied field when possible.",
            "DeviceCustomString4Label":"Type: string. <br>All custom fields have a corresponding label field. Each of these fields is a string and describes the purpose of the custom field.",
            "DeviceCustomString5":"Type: string. <br>One of six strings available to map fields that do not apply to any other in this dictionary. Use sparingly and seek a more specific, dictionary supplied field when possible.",
            "DeviceCustomString5Label":"Type: string. <br>All custom fields have a corresponding label field. Each of these fields is a string and describes the purpose of the custom field.",
            "DeviceCustomString6":"Type: string. <br>One of six strings available to map fields that do not apply to any other in this dictionary. Use sparingly and seek a more specific, dictionary supplied field when possible.",
            "DeviceCustomString6Label":"Type: string. <br>All custom fields have a corresponding label field. Each of these fields is a string and describes the purpose of the custom field.",
            "DeviceDnsDomain":"Type: string. <br>The DNS domain part of the full qualified domain name (FQDN).",
            "DeviceEventCategory":"Type: string. <br>Represents the category assigned by the originating device. Devices often use their own categorization schema to classify event. Example: '/Monitor/Disk/Read'.",
            "DeviceEventClassID":"Type: string. <br>String or integer that serves as a unique identifier per event type.",
            "DeviceExternalID":"Type: string. <br>A name that uniquely identifies the device generating the event.",
            "DeviceFacility":"Type: string. <br>The facility generating the event. For example: auth or local1.",
            "DeviceInboundInterface":"Type: string. <br>The interface on which the packet or data entered the device. For example: ethernet1/2.",
            "DeviceMacAddress":"Type: string. <br>The MAC address of the device generating the event.",
            "DeviceName":"Type: string. <br>The FQDN associated with the device node, when a node is available. For example: host.domain.com or host.",
            "DeviceNtDomain":"Type: string. <br>The Windows domain of the device address.",
            "DeviceOutboundInterface":"Type: string. <br>Interface on which the packet or data left the device.",
            "DevicePayloadId":"Type: string. <br>Unique identifier for the payload associated with the event.",
            "DeviceProduct":"Type: string. <br>String that together with device product and version definitions, uniquely identifies the type of sending device.",
            "DeviceTimeZone":"Type: string. <br>Timezone of the device generating the event.",
            "DeviceTranslatedAddress":"Type: string. <br>Identifies the translated device address that the event refers to, in an IP network. The format is an Ipv4 address.",
            "DeviceVendor":"Type: string. <br>String that together with device product and version definitions, uniquely identifies the type of sending device.",
            "DeviceVersion":"Type: string. <br>String that together with device product and version definitions, uniquely identifies the type of sending device.",
            "EndTime":"Type: datetime. <br>The time at which the activity related to the event ended.",
            "EventCount":"Type: int. <br>A count associated with the event, showing how many times the same event was observed.",
            "EventOutcome":"Type: string. <br>Displays the outcome, usually as 'success' or 'failure'.",
            "EventType":"Type: int. <br>Event type. Value values include: 0: base event, 1: aggregated, 2: correlation event, 3: action event. Note: This event can be omitted for base events.",
            "ExternalID":"Type: int. <br>Soon to be a deprecated field. Will be replaced by ExtID.",
            "ExtID":"Type: string. <br>An ID used by the originating device (will replace legacy ExternalID). Typically, these values have increasing values that are each associated with an event.",
            "FieldDeviceCustomNumber1":"Type: long. <br>One of three number fields available to map fields that do not apply to any other in this dictionary (will replace legacy DeviceCustomNumber1). Use sparingly and seek a more specific, dictionary supplied field when possible.",
            "FieldDeviceCustomNumber2":"Type: long. <br>One of three number fields available to map fields that do not apply to any other in this dictionary (will replace legacy DeviceCustomNumber2). Use sparingly and seek a more specific, dictionary supplied field when possible.",
            "FieldDeviceCustomNumber3":"Type: long. <br>One of three number fields available to map fields that do not apply to any other in this dictionary (will replace legacy DeviceCustomNumber3). Use sparingly and seek a more specific, dictionary supplied field when possible.",
            "FileCreateTime":"Type: string. <br>Time when the file was created.",
            "FileHash":"Type: string. <br>Hash of a file.",
            "FileID":"Type: string. <br>An ID associated with a file, such as the inode.",
            "FileModificationTime":"Type: string. <br>Time when the file was last modified.",
            "FileName":"Type: string. <br>The file's name, without the path.",
            "FilePath":"Type: string. <br>Full path to the file, including the filename. For example: C:\\ProgramFiles\\WindowsNT\\Accessories\\wordpad.exe or /usr/bin/zip.",
            "FilePermission":"Type: string. <br>The file's permissions. For example: '2,1,1'.",
            "FileSize":"Type: int. <br>The size of the file in bytes.",
            "FileType":"Type: string. <br>File type, such as pipe, socket, and so on.",
            "FlexDate1":"Type: string. <br>A timestamp field available to map a timestamp that does not apply to any other defined timestamp field in this dictionary. Use all flex fields sparingly and seek a more specific, dictionary supplied field when possible. These fields are typically reserved for customer use and should not be set by vendors unless necessary.",
            "FlexDate1Label":"Type: string. <br>The label field is a string and describes the purpose of the flex field.",
            "FlexNumber1":"Type: int. <br>Number fields available to map Int data that does not apply to any other field in this dictionary.",
            "FlexNumber1Label":"Type: string. <br>The label that describes the value in FlexNumber1",
            "FlexNumber2":"Type: int. <br>Number fields available to map Int data that does not apply to any other field in this dictionary.",
            "FlexNumber2Label":"Type: string. <br>The label that describes the value in FlexNumber2",
            "FlexString1":"Type: string. <br>One of four floating point fields available to map fields that do not apply to any other in this dictionary. Use sparingly and seek a more specific, dictionary supplied field when possible. These fields are typically reserved for customer use and should not be set by vendors unless necessary.",
            "FlexString1Label":"Type: string. <br>The label field is a string and describes the purpose of the flex field.",
            "FlexString2":"Type: string. <br>One of four floating point fields available to map fields that do not apply to any other in this dictionary. Use sparingly and seek a more specific, dictionary supplied field when possible. These fields are typically reserved for customer use and should not be set by vendors unless necessary.",
            "FlexString2Label":"Type: string. <br>The label field is a string and describes the purpose of the flex field.",
            "IndicatorThreatType":"Type: string. <br>The threat type of the MaliciousIP according to our TI feed.",
            "LogSeverity":"Type: string. <br>A string or integer that describes the importance of the event. Valid string values: Unknown , Low, Medium, High, Very-High Valid integer values are: 0-3 = Low, 4-6 = Medium, 7-8 = High, 9-10 = Very-High.",
            "MaliciousIP":"Type: string. <br>If one of the IP in the message was correlate with the current TI feed we have it will show up here.",
            "MaliciousIPCountry":"Type: string. <br>The country of the MaliciousIP according to the GEO information at the time of the record ingestion.",
            "MaliciousIPLatitude":"Type: real. <br>The Latitude of the MaliciousIP according to the GEO information at the time of the record ingestion.",
            "MaliciousIPLongitude":"Type: real. <br>The Longitude of the MaliciousIP according to the GEO information at the time of the record ingestion.",
            "Message":"Type: string. <br>A message that gives more details about the event.",
            "OldFileCreateTime":"Type: string. <br>Time when the old file was created.",
            "OldFileHash":"Type: string. <br>Hash of the old file.",
            "OldFileID":"Type: string. <br>And ID associated with the old file, such as the inode.",
            "OldFileModificationTime":"Type: string. <br>Time when the old file was last modified.",
            "OldFileName":"Type: string. <br>Name of the old file.",
            "OldFilePath":"Type: string. <br>Full path to the old file, including the filename. For example: C:\\ProgramFiles\\WindowsNT\\Accessories\\wordpad.exe or /usr/bin/zip.",
            "OldFilePermission":"Type: string. <br>Permissions of the old file. For example: '2,1,1'.",
            "OldFileSize":"Type: int. <br>The size of the old file in bytes.",
            "OldFileType":"Type: string. <br>File type of the old file, such as a pipe, socket, and so on.",
            "OriginalLogSeverity":"Type: string. <br>A non-mapped version of LogSeverity. For example: Warning/Critical/Info insted of the normilized Low/Medium/High in the LogSeverity Field",
            "ProcessID":"Type: int. <br>Defines the ID of the process on the device generating the event.",
            "ProcessName":"Type: string. <br>Process name associated with the event. For example: in UNIX, the process generating the syslog entry.",
            "Protocol":"Type: string. <br>Transport protocol that identifies the Layer-4 protocol used. Possible values include protocol names, such as TCP or UDP.",
            "Reason":"Type: string. <br>The reason an audit event was generated. For example 'bad password' or 'unknown user'. This could also be an error or return code. Example: '0x1234'.",
            "ReceiptTime":"Type: string. <br>The time at which the event related to the activity was received. Different then the 'Timegenerated' field, which is when the event was recieved in the log collector machine.",
            "ReceivedBytes":"Type: long. <br>Number of bytes transferred inbound.",
            "RemoteIP":"Type: string. <br>The remote IP address, derived from the event's direction value, if possible.",
            "RemotePort":"Type: string. <br>The remote port, derived from the event's direction value, if possible.",
            "ReportReferenceLink":"Type: string. <br>Link to the report of the TI feed.",
            "RequestClientApplication":"Type: string. <br>The user agent associated with the request.",
            "RequestContext":"Type: string. <br>Describes the content from which the request originated, such as the HTTP Referrer.",
            "RequestCookies":"Type: string. <br>Cookies associated with the request.",
            "RequestMethod":"Type: string. <br>The method used to access a URL. Valid values include methods such as POST, GET, and so on.",
            "RequestURL":"Type: string. <br>The URL accessed for an HTTP request, including the protocol. For example: http://www/secure.com.",
            "_ResourceId":"Type: string. <br>A unique identifier for the resource that the record is associated with",
            "SentBytes":"Type: long. <br>Number of bytes transferred outbound.",
            "SimplifiedDeviceAction":"Type: string. <br>A mapped version of DeviceAction, such as Denied > Deny.",
            "SourceDnsDomain":"Type: string. <br>The DNS domain part of the complete FQDN.",
            "SourceHostName":"Type: string. <br>Identifies the source that event refers to in an IP network. Format should be a fully qualified domain name (DQDN) associated with the source node, when a node is available. For example: host or host.domain.com.",
            "SourceIP":"Type: string. <br>The source that an event refers to in an IP network, as an IPv4 address.",
            "SourceMACAddress":"Type: string. <br>Source MAC address.",
            "SourceNTDomain":"Type: string. <br>The Windows domain name for the source address.",
            "SourcePort":"Type: int. <br>The source port number. Valid port numbers are 0 - 65535.",
            "SourceProcessId":"Type: int. <br>The ID of the source process associated with the event.",
            "SourceProcessName":"Type: string. <br>The name of the event's source process.",
            "SourceServiceName":"Type: string. <br>The service responsible for generating the event.",
            "SourceSystem":"Type: string. <br>Hard coded- 'OpsManager'.",
            "SourceTranslatedAddress":"Type: string. <br>Identifies the translated source that the event refers to in an IP network.",
            "SourceTranslatedPort":"Type: int. <br>Source port after translation, such as a firewall. Valid port numbers are 0 - 65535.",
            "SourceUserID":"Type: string. <br>Identifies the source user by ID.",
            "SourceUserName":"Type: string. <br>Identifies the source user by name. Email addresses are also mapped into the UserName fields. The sender is a candidate to put into this field.",
            "SourceUserPrivileges":"Type: string. <br>The source user's privileges. Valid values include: Administrator, User, Guest.",
            "StartTime":"Type: datetime. <br>The time when the activity that the event refers to started.",
            "_SubscriptionId":"Type: string. <br>A unique identifier for the subscription that the record is associated with",
            "TenantId":"Type: string. <br>",
            "ThreatConfidence":"Type: string. <br>The threat confidence of the MaliciousIP according to our TI feed.",
            "ThreatDescription":"Type: string. <br>The threat description of the MaliciousIP according to our TI feed.",
            "ThreatSeverity":"Type: int. <br>The threat severity of the MaliciousIP according to our TI feed at the time of the record ingestion.",
            "TimeGenerated":"Type: datetime. <br>Event collection time in UTC.",
            "Type":"Type: string. <br>The name of the table"
        },
        "Common Event Format (CEF) via AMA": "",
        "DNS": "",
        "Fortinet FortiWeb Web Application Firewall": "",
        "Microsoft 365 Defender (TF-Connector: MicrosoftThreatProtection)": {
            "SecurityIncident": "",
            "SecurityAlert": "",
            "DeviceEvents": "",
            "DeviceFileEvents": "",
            "DeviceImageLoadEvents": "",
            "DeviceInfo": "",
            "DeviceLogonEvents": "",
            "DeviceNetworkEvents": "",
            "DeviceNetworkInfo": "",
            "DeviceProcessEvents": "",
            "DeviceRegistryEvents": "",
            "DeviceFileCertificateInfo": "",
            "EmailEvents": "",
            "EmailUrlInfo": "",
            "EmailAttachmentInfo": "",
            "EmailPostDeliveryEvents": "",
            "UrlClickEvents": "",
            "IdentityLogonEvents": "",
            "IdentityQueryEvents": "",
            "IdentityDirectoryEvents": "",
            "CloudAppEvents": "",
            "AlertInfo": "Information about alerts from Microsoft 365 Defender components",
            "AlertEvidence": "Information about various entities - files, IP addresses, URLs, users, devices - associated with alerts from Microsoft 365 Defender components"
        },
        "Microsoft 365 Insider Risk Management": "",
        "Microsoft Defender for Cloud": "",
        "Microsoft Defender for Cloud Apps": {
            "CloudAppEvents": "Information about activities in various cloud apps and services covered by Microsoft Defender for Cloud Apps"
        },
        "Microsoft Defender for Endpoint": {
            "DeviceInfo": "Machine information, including OS information",
            "DeviceNetworkInfo": "Network properties of devices, including physical adapters, IP and MAC addresses, as well as connected networks and domains",
            "DeviceProcessEvents": "Process creation and related events",
            "DeviceNetworkEvents": "Network connection and related events",
            "DeviceFileEvents": "File creation, modification, and other file system events",
            "DeviceRegistryEvents": "Creation and modification of registry entries",
            "DeviceLogonEvents": "Sign-ins and other authentication events on devices",
            "DeviceImageLoadEvents": "DLL loading events",
            "DeviceEvents": "Multiple event types, including events triggered by security controls such as Windows Defender Antivirus and exploit protection",
            "DeviceFileCertificateInfo": "Certificate information of signed files obtained from certificate verification events on endpoints"
        },
        "Microsoft Defender for Identity": {
            "IdentityDirectoryEvents": "Various identity-related events, like password changes, password expirations, and user principal name (UPN) changes, captured from an on-premises Active Directory domain controller \nAlso includes system events on the domain controller",
            "IdentityInfo": "Information about user accounts obtained from various services, including Azure Active Directory",
            "IdentityLogonEvents": "Authentication activities made through your on-premises Active Directory, as captured by Microsoft Defender for Identity\nAuthentication activities related to Microsoft online services, as captured by Microsoft Defender for Cloud Apps",
            "IdentityQueryEvents": "Information about queries performed against Active Directory objects such as users, groups, devices, and domains"

        },
        "Microsoft Defender for IoT": "",
        "Microsoft Defender for Office 365": {
            "EmailEvents": "Microsoft 365 email events, including email delivery and blocking events",
            "EmailUrlInfo": "Information about URLs on emails",
            "EmailAttachmentInfo": "Information about files attached to emails",
            "EmailPostDeliveryEvents": "Security events that occur post-delivery, after Microsoft 365 has delivered the emails to the recipient mailbox"
        },
        "Microsoft PowerBI": "",
        "Microsoft Project": "",
        "Microsoft Purview (Preview)": "",
        "Microsoft Purview Information Protection": "",
        "Network Security Groups": "",
        "Office 365": "",
        "Security Events via Legacy Agent": "",
        "SentinelOne (using Azure Function)": "",
        "Syslog": "",
        "Threat intelligence - TAXII": "",
        "Threat Intelligence Platforms": "",
        "Threat Intelligence Upload Indicators API (Preview)": "",
        "Windows DNS Events via AMA (Preview)": "",
        "Windows Firewall": "",
        "Windows Firewall Events via AMA (Preview)": "",
        "Windows Forwarded Events": "",
        "Windows Security Events via AMA": ""
    },
    "Microsoft Corporation": {
        "Azure Firewall": "",
        "Dynamics 365": ""
    },
    "Microsoft Corporation - sentinel4github": {
        "GitHub (using Webhooks) (using Azure Function)": "",
        "GitHub Enterprise Audit Log": ""
    },
    "Microsoft Sentinel Community, Microsoft Corporation": {
        "Forcepoint CASB": "",
        "Forcepoint CSG": "",
        "Forcepoint DLP": "",
        "Forcepoint NGFW": ""
    }
};
function randID() {
    return Math.random().toString(36).substring(2, 8);
}
function generateHTML(data) {
    let html = '';
    for (let key in data) {
        html += `<details id="${randID()}"><summary>${key}</summary>`;
        if (typeof data[key] === 'string') {
            html += `<div class="content">${data[key]}</div>`;
        } else {
            html += generateHTML(data[key]);
        }
        html += '</details>';
    }
    return html;
}

const container = document.getElementById('jayson');
container.innerHTML = generateHTML(data);

function highlightMatches(searchTerm) {
    const regex = new RegExp(`(${searchTerm})`, "gi");
    const elements = document.querySelectorAll("summary");

    for (let element of elements) {
        if (element.innerHTML) {
            const newHTML = element.innerHTML.replace(regex, '<span class="search-hit">$1</span>');
            element.innerHTML = newHTML;
            const hits = element.querySelectorAll(".search-hit");
            for (let hit of hits) {
                const parent = hit.parentElement;
                if (parent) {
                    parent.classList.add("search-hit");
                }
            }
        }
    }
}

function removeSearchHits() {
    const elements = document.querySelectorAll(".search-hit");
    for (let element of elements) {
        element.classList.remove("search-hit");
    }
}

function searchNestedDetails() {
    removeSearchHits();
    const searchTerm = document.getElementById("search-input").value.toLowerCase();
    const details = document.querySelectorAll("details");

    for (let detail of details) {
        if (detail.innerHTML.toLowerCase().includes(searchTerm)) {
            openParentDetails(detail);
        } else {
            searchNestedSummaries(detail, searchTerm);
        }
    }
    highlightMatches(searchTerm);
}

function searchNestedSummaries(parentDetail, searchTerm) {
    const summaries = parentDetail.querySelectorAll("summary");

    for (let summary of summaries) {
        if (summary.textContent.toLowerCase().includes(searchTerm)) {
            openParentDetails(summary.closest('details'));
            highlightMatches(summary, searchTerm);
        }
        const nestedDetails = summary.parentElement.querySelectorAll("details");
        for (let nestedDetail of nestedDetails) {
            searchNestedSummaries(nestedDetail, searchTerm);
        }
    }
}

function openParentDetails(detail) {
    const parentDetails = getParents(detail, "details");
    for (let parentDetail of parentDetails) {
        parentDetail.open = true;
    }
}

function getParents(element, parentTagName) {
    const parents = [];
    let parent = element.parentElement;

    while (parent) {
        if (parent.tagName.toLowerCase() === parentTagName) {
            parents.push(parent);
        }
        parent = parent.parentElement;
    }

    return parents;
}


function collapseAllDetails() {
    const details = document.querySelectorAll("details");
    for (let detail of details) {
        detail.open = false;
    }
}

const collapseButton = document.getElementById("collapse-button");
collapseButton.addEventListener("click", collapseAllDetails);


const searchButton = document.getElementById("search-button");
searchButton.addEventListener("click", searchNestedDetails);



